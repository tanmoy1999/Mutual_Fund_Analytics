import requests
import json
from csv import writer
import numpy as np
import time
import datetime
from mailjet_rest import Client
import os

def mail_Alert():
    print("Reports Mailing to: rayajil583@luxiu2.com")
    time.sleep(5)
    api_key = 'af58559ae7ae499a80cf70a88809ed4e'
    api_secret = '84854026ae41c83381ac321fa5fd3578'
    mailjet = Client(auth=(api_key, api_secret), version='v3.1')
    data = {
    'Messages': [
        {
        "From": {
            "Email": "rayajil583@luxiu2.com",
            "Name": "Rolling"
        },
        "To": [
            {
            "Email": "rayajil583@luxiu2.com",
            "Name": "Rolling"
            }
        ],
        "Subject": "MF ANALYTICS",
        "TextPart": "My first Mailjet email",
        "HTMLPart": "<h3>Dear passenger 1, welcome to <a href='https://www.mailjet.com/'>Mailjet</a>!</h3><br />May the delivery force be with you!",
        "Attachments": [
                                    {
                                            "ContentType": "text/csv",
                                            "Filename": "/output/test.csv",
                                            "Base64Content": "VGhpcyBpcyB5b3VyIGF0dGFjaGVkIGZpbGUhISEK"
                                    }
                            ]
        }
    ]
    }
    result = mailjet.send.create(data=data)
    print(result.status_code)
    print(result.json())

start_time = time.time()
print(start_time)

x = datetime.datetime.now()
datetimevar = str(x.strftime("%d%m%Y%H%M%S"))
filename = "output/" + datetimevar + ".csv"
# filename = "output/test.csv"

print(filename)

response = requests.get('https://api.mfapi.in/mf/101188').text
response1 = requests.get('https://api.mfapi.in/mf').text

response_info = json.loads(response)
listMF = json.loads(response1)

schemeCode = [120035, 120036, 115116, 115117, 118267, 103390, 103389, 118268, 103475, 103476, 119514, 119515, 134923, 134925, 134922, 134924, 118556, 118557, 112093, 112092, 138524, 138527, 138528, 138523, 140102, 119272, 119271, 115882, 115881, 120034, 120033, 103407, 103406, 112600, 118564, 118563, 105816, 105817, 112601, 120684, 120683, 141665, 134013, 140085, 119412, 119413, 112957, 112958, 118348, 118456, 113249, 113250, 135813, 135816, 135817, 135814, 135818, 135815, 118760, 118762, 118763, 101262, 101263, 101264, 120185, 120186, 112173, 117619, 117620, 120394, 120395, 112171, 133839, 133837, 120729, 120728, 102396, 102395, 133836, 133838, 119171, 119172, 101833, 100415, 119695, 119700, 106096, 106095, 120494, 120493, 119243, 119244, 107287, 107288, 101766, 101852, 133801, 133800, 133796, 133799, 120578, 119731, 100643, 120577, 140094, 118468, 114476, 118469, 141957, 120492, 106653, 120491, 109523, 109522, 119247, 102434, 119248, 102435, 141921, 141924, 141922, 141923, 119465, 114477, 118525, 118524, 103361, 103360, 120405, 103334, 103335, 129222, 129220, 119464, 129223, 120846, 120847, 129221, 106654, 100174, 100175, 120833, 120832, 119451, 120404, 106169, 106170, 100967, 119452, 119715, 119716, 100966, 102942, 102941, 120622, 127850, 127852, 127851, 127849, 118729, 118727, 118726, 102172, 102173, 102174, 119095, 119096, 120621, 113032, 112901, 103149, 139455, 135744, 119775, 134782, 119774, 104908, 104907, 118879, 118880, 139865, 139872, 139866, 105417, 139871, 139870, 139863, 128639, 103150, 105418, 130825, 119852, 119853, 119854, 130828, 112489, 112487, 112488, 130827, 130826, 132873, 118780, 118781, 119733, 112941, 119732, 112939, 112938, 132871, 120163, 120164, 112923, 113099, 102874, 102875, 120818, 120819, 101070, 101069, 140459, 118978, 118979, 107524, 120485, 120486, 106168, 100254, 107525, 140460, 140458, 120595, 120594, 119838, 119839, 119836, 119837, 140461, 100927, 100929, 100968, 100928, 115294, 119213, 119212, 100363, 105989, 113153, 119249, 119602, 119601, 119250, 120351, 140453, 120350, 140448, 140449, 119488, 119487, 140450, 140451, 140452, 141596, 101636, 101635, 106370, 100153, 100152, 106369, 107763, 107764, 119719, 101169, 112495, 119807, 120483, 120484, 133406, 131477, 130904, 133412, 133402, 133401, 133409, 114984, 133405, 133408, 133404, 131476, 100221, 133400, 133403, 133407, 133410, 100220, 119806, 120748, 120743, 131622, 120747, 112496, 118462, 118531, 100365, 100364, 131623, 100367, 100471, 100470, 133566, 133568, 133630, 120136, 120137, 101002, 101003, 130787, 120401, 120400, 133565, 133631, 133567, 105604, 105603, 139221, 139219, 139224, 139222, 118950, 134641, 134643, 134640, 118949, 134642, 134644, 102761, 134639, 102760, 118968, 118969, 119029, 119028, 138878, 138875, 138877, 100120, 100119, 119770, 138876, 119771, 108203, 138883, 138887, 140274, 108202, 105967, 130450, 105968, 130447, 140273, 130449, 130448, 118421, 133679, 130452, 118475, 120820, 120821, 118474, 130446, 118587, 118585, 128821, 108847, 130206, 119574, 130209, 108845, 141606, 119525, 119567, 113345, 133680, 119526, 113346, 104458, 128820, 120795, 104457, 120796, 141605, 112087, 130205, 130208, 130207, 112088, 140805, 101072, 140801, 101071, 140807, 104075, 140803, 133181, 104074, 138387, 118422, 140806, 140802, 133184, 120333, 120364, 140808, 130773, 120365, 140804, 130774, 129052, 120481, 135172, 133398, 135171, 120482, 133397, 135174, 135173, 104683, 133395, 130604, 131055, 118930, 135167, 104681, 130771, 130603, 133394, 131059, 131057, 135170, 118931, 131061, 131056, 135169, 103780, 133396, 133399, 131053, 103781, 131058, 119516, 131051, 131054, 135168, 130776, 119517, 131062, 141209, 106795, 106822, 129054, 142035, 142036, 126391, 119393, 106793, 119394, 119310, 119395, 106873, 119311, 116555, 106872, 119776, 106797, 119396, 116556, 129053, 140387, 119954, 129051, 111714, 111715, 119953, 111717, 119777, 111713, 111712, 111716, 126393, 134957, 134958, 120490, 134960, 134956, 102046, 120489, 102573, 119347, 101945, 119341, 102574, 106796, 101049, 101042, 119340, 138386, 106799, 119293, 133871, 119128, 108593, 119348, 120870, 118191, 138381, 101188, 101187, 134954, 134961, 138382, 100219, 134955, 133870, 101585, 126394, 100218, 140386, 134959, 110607, 141207, 141210, 110608, 119129, 118192, 110604, 106823, 115270, 141208, 119734, 119735, 101586, 126392, 140388, 119709, 119708, 119796, 119540, 119795, 119539, 119538, 119794, 100299, 119541, 119797, 100300, 118078, 127181, 118076, 140385, 108592, 119292, 127184, 120591, 128337, 118077, 101295, 104523, 106317, 118080, 111811, 106316, 111803, 111812, 111809, 127183, 127182, 128332, 139235, 120038, 120039, 120040, 118305, 118304, 118306, 121281, 121936, 109351, 109353, 121935, 119758, 121934, 119757, 119759, 118902, 118903, 121279, 121938, 121932, 121280, 121937, 121933, 121931, 119462, 121282, 120332, 119463, 120618, 118909, 120619, 131480, 120617, 101466, 101465, 120839, 120836, 116051, 100264, 100265, 100281, 120838, 120837, 100280, 119630, 125343, 119622, 119621, 125345, 131481, 109740, 115290, 100788, 100787, 109743, 100785, 139237, 139240, 119631, 109741, 125259, 119116, 100789, 127470, 119115, 125337, 100786, 139582, 139584, 119306, 119307, 129646, 101083, 103226, 101084, 103225, 120407, 119766, 103227, 103228, 120431, 120428, 120430, 120406, 120249, 139257, 139258, 139433, 139434, 120408, 139563, 139561, 132009, 119090, 119091, 119088, 120410, 120391, 120389, 120390, 120198, 120191, 120189, 120196, 120187, 132010, 120190, 100234, 100835, 101549, 100622, 100244, 100247, 119161, 119162, 119164, 112210, 112213, 112212, 100233, 130479, 132003, 130489, 100876, 100868, 100874, 116052, 120059, 112646, 101185, 112647, 112636, 139386, 132005, 120339, 103342, 120101, 115505, 112119, 103341, 104308, 100357, 119125, 120337, 130476, 130472, 139889, 139890, 120338, 100222, 119690, 101181, 100223, 130459, 119689, 119686, 119692, 129648, 118859, 118860, 118862, 103347, 120336, 119687, 139821, 101686, 103395, 105823, 119223, 100619, 100618, 101685, 103397, 111644, 105856, 111645, 111646, 105822, 103393, 118364, 118365, 118363, 100623, 119226, 118328, 105857, 119222, 103396, 118907, 108693, 115489, 108690, 119224, 139820, 101306, 131398, 118413, 101303, 112714, 118447, 118411, 119110, 127310, 118408, 118410, 101304, 101305, 118412, 117867, 118414, 127305, 118341, 120255, 118446, 108546, 140006, 131148, 140003, 112713, 112715, 119551, 119552, 119553, 119550, 118561, 108545, 120256, 109576, 118562, 115874, 101996, 127319, 120258, 108547, 131399, 107249, 107251, 127315, 107248, 108544, 110490, 103176, 108273, 106157, 108274, 107252, 110282, 108272, 107247, 118560, 119417, 107250, 109575, 127307, 112344, 118321, 127308, 116174, 127304, 127320, 118034, 118320, 112342, 118031, 131147, 119425, 118030, 120439, 120436, 120438, 118322, 119426, 119418, 118047, 119337, 118048, 117448, 117449, 117446, 119336, 119100, 127471, 115077, 115079, 119101, 120050, 119099, 119801, 129649, 118992, 131898, 119992, 115078, 119996, 119995, 119991, 131897, 110601, 119802, 118994, 130725, 130722, 130724, 120048, 117631, 119994, 117629, 120051, 118670, 118993, 118672, 118673, 131895, 133265, 118669, 119350, 118674, 100086, 131896, 119305, 119303, 119302, 113526, 124173, 124182, 124183, 124177, 124175, 100084, 119304, 124176, 124178, 140024, 120558, 120304, 120777, 141768, 134427, 120794, 140913, 140504, 126685, 106739, 112429, 100085, 112428, 126686, 115400, 115402, 115398, 115399, 119300, 124172, 124179, 124181, 124174, 124180, 133973, 102011, 102010, 102012, 139838, 140517, 102013, 110438, 135721, 117961, 106737, 106738, 110439, 118449, 118345, 126163, 133307, 139496, 115883, 117960, 126687, 117959, 139539, 117957, 135795, 135798, 135800, 106741, 117962, 113096, 113104, 117958, 139538, 139536, 109717, 126688, 110440, 106736, 108220, 109723, 109720, 109721, 109724, 109716, 130723, 130721, 130726, 119666, 117447, 119663, 119665, 119664, 119662, 118454, 119668, 139537, 139541, 119502, 132918, 138441, 119505, 118453, 119503, 118452, 118573, 118570, 120786, 120785, 138443, 119126, 102448, 118281, 118282, 115886, 119127, 119073, 118528, 133369, 118569, 118572, 138439, 118571, 102450, 119098, 138446, 102451, 100504, 100813, 100814, 120710, 119075, 118529, 133928, 133923, 118530, 119097, 113135, 120711, 119072, 119074, 119445, 119448, 119446, 119447, 133924, 100503, 133925, 119803, 102767, 101562, 132917, 111848, 133926, 101566, 118332, 101564, 119844, 119846, 120709, 101563, 111521, 100527, 102766, 138424, 134341, 100530, 134424, 101565, 124595, 101909, 119847, 133920, 100529, 112414, 120601, 101224, 133927, 134423, 125502, 125504, 100528, 102723, 125503, 125505, 105461, 102722, 102724, 101561, 119682, 138427, 100531, 120602, 112416, 133921, 138423, 119950, 119949, 119138, 119137, 119135, 119139, 101560, 119677, 120600, 112420, 118812, 120603, 112410, 133974, 135796, 135797, 135799, 138429, 101605, 119678, 115887, 114983, 119753, 120448, 119681, 102009, 102007, 102008, 118807, 101703, 120449, 119680, 138430, 120447, 138432, 114240, 118809, 118555, 119755, 138431, 118808, 118814, 138425, 114982, 134342, 130312, 114239, 115995, 115991, 115993, 120474, 120604, 115994, 118811, 112304, 120697, 120693, 118554, 125500, 114630, 125498, 125501, 125499, 125266, 112305, 100857, 136302, 119016, 101588, 132982, 120475, 130314, 120590, 116470, 114241, 133367, 100858, 120694, 120476, 120589, 131152, 120670, 120672, 113218, 100859, 120695, 101587, 100856, 120692, 120696, 120764, 135290, 125267, 105550, 116472, 101873, 109472, 109473, 120765, 113403, 105561, 105549, 120671, 105566, 111987, 101874, 130311, 133370, 119015, 105556, 111989, 101872, 112096, 111992, 116471, 120435, 105552, 112097, 111991, 135418, 105563, 120434, 133388, 101547, 108511, 140604, 105557, 101351, 139200, 117998, 133414, 133975, 105564, 105562, 101875, 111988, 118329, 101548, 131151, 140610, 120433, 113047, 105551, 122315, 120755, 118428, 116896, 131382, 113048, 133368, 111990, 100369, 140603, 120754, 131419, 120753, 118295, 118429, 132981, 100368, 118291, 116895, 105558, 116894, 102741, 139199, 139198, 131418, 129008, 118405, 118292, 134388, 134387, 134385, 131478, 133344, 123402, 117330, 118407, 128626, 135917, 139201, 129009, 113137, 120437, 118457, 116811, 135916, 128629, 117981, 130313, 117982, 118349, 130310, 136465, 120563, 120561, 120560, 120562, 135051, 119672, 118458, 120559, 102913, 102914, 130309, 118463, 113144, 139203, 119676, 119675, 118466, 123403, 118406, 123401, 139205, 119068, 118415, 118465, 119069, 101805, 118464, 118467, 119805, 119799, 119800, 119804, 119369, 129007, 133390, 133389, 135419, 120315, 119370, 131394, 108768, 118417, 105637, 123406, 133365, 101806, 131383, 122323, 118416, 139202, 128627, 129006, 120568, 120567, 120570, 120569, 120571, 115005, 118696, 118700, 118701, 118698, 140609, 122618, 109255, 109254, 116810, 114999, 120317, 105274, 105275, 105283, 105282, 105280, 105279, 105281, 140607, 101758, 134384, 115000, 118418, 135914, 116582, 108767, 120197, 101759, 131479, 118804, 128628, 120318, 116583, 108558, 108713, 140612, 135915, 139204, 105661, 131396, 111675, 105663, 119809, 134386, 100855, 112340, 100851, 100853, 134421, 120535, 134425, 105660, 105662, 104729, 133604, 115458, 104726, 104725, 118403, 119861, 119808, 134383, 101165, 140611, 103340, 133606, 108559, 111527, 119439, 119410, 119309, 119411, 119409, 112026, 105190, 120537, 139389, 120536, 139387, 118404, 111525, 118399, 100498, 119570, 118518, 101830, 119571, 119568, 122786, 117973, 116110, 105189, 105185, 105192, 105191, 131395, 118495, 100499, 119499, 102672, 131384, 118496, 119501, 140608, 118517, 118395, 118402, 104486, 104485, 104492, 129197, 119790, 118401, 122235, 118942, 100609, 118394, 112034, 112027, 118577, 112035, 112032, 108557, 112029, 112031, 112033, 131397, 112025, 118393, 118944, 118945, 141890, 141889, 101829, 120066, 131386, 100048, 111523, 101316, 138375, 119424, 105887, 105881, 101317, 100042, 100047, 100043, 138376, 119400, 100051, 118943, 103885, 112458, 112457, 100608, 119399, 120133, 108675, 118369, 119468, 119466, 100610, 100546, 100603, 138377, 100602, 118370, 120063, 100604, 119792, 118396, 101847, 119865, 118840, 118841, 118842, 119957, 119863, 119740, 120132, 120131, 118371, 100898, 104722, 100897, 105024, 104723, 104728, 118134, 111524, 122868, 119094, 119092, 120067, 118133, 140463, 118797, 119741, 108763, 105187, 119793, 102113, 134556, 131387, 134547, 134555, 134552, 118800, 119496, 118796, 118373, 134550, 108635, 108634, 118372, 108632, 104348, 105543, 105548, 125269, 115464, 119285, 119282, 119283, 103159, 103158, 119831, 119833, 119798, 108561, 119832, 101995, 101993, 134422, 119512, 118750, 131385, 119511, 116020, 118747, 108764, 116413, 108730, 108731, 134554, 134553, 101242, 118568, 101232, 118566, 101238, 118567, 101236, 118565, 102452, 119746, 119747, 133607, 119498, 108728, 136466, 113169, 102114, 118749, 119382, 101971, 101976, 101206, 103140, 114297, 101970, 118298, 101244, 101974, 133605, 101892, 101893, 133972, 104344, 111590, 141375, 118066, 118058, 118065, 119497, 133971, 126940, 112016, 118299, 108765, 119712, 118661, 120010, 133366, 121940, 140116, 104351, 117954, 113036, 104352, 108766, 102453, 134426, 100124, 140135, 129195, 129196, 136110, 119713, 100123, 113037, 134026, 140465, 119383, 119714, 126942, 118552, 108727, 126939, 102851, 102849, 110606, 110603, 108729, 126941, 116154, 107705, 113548, 117955, 107702, 119384, 107704, 134545, 134548, 119523, 100844, 100837, 100838, 100843, 116153, 117974, 102506, 113547, 122646, 122648, 131390, 139407, 118656, 111585, 118553, 104488, 104489, 102505, 131512, 131444, 120746, 120744, 139568, 133059, 139430, 121892, 113557, 117952, 120008, 117953, 138358, 134551, 134549, 118211, 118655, 113477, 113549, 138369, 117956, 135497, 125268, 120544, 136112, 120542, 120541, 120543, 138372, 112356, 122650, 122649, 122647, 124590, 122644, 138359, 111343, 120719, 111589, 128050, 124589, 131548, 131301, 101667, 120718, 101665, 101843, 131425, 118660, 138362, 119474, 118387, 119475, 102673, 140617, 118388, 138337, 104350, 120212, 120213, 140619, 131303, 138371, 140618, 101844, 101669, 120211, 108644, 120216, 133147, 140613, 120210, 102675, 118390, 128051, 110599, 120500, 119786, 118389, 120496, 120497, 120513, 120499, 120501, 118318, 120516, 120514, 118717, 118715, 131298, 118719, 118716, 118720, 118317, 131299, 118319, 103637, 138339, 100597, 108753, 133488, 104342, 117715, 104343, 103633, 103636, 103635, 117716, 130013, 113476, 100640, 131391, 124962, 131304, 108646, 100596, 103051, 112083, 103052, 103048, 112341, 118284, 133524, 119823, 100639, 100538, 131302, 112942, 119820, 138341, 131297, 119204, 119206, 131300, 119207, 119205, 100314, 120278, 119671, 121944, 141590, 120279, 133520, 141586, 102677, 134332, 138343, 119785, 119822, 100638, 119670, 118283, 134517, 134799, 102531, 134484, 131511, 121891, 133873, 102532, 131445, 119821, 112718, 112216, 112719, 112214, 112717, 112217, 113478, 119655, 116109, 129437, 100315, 119430, 103195, 106179, 134506, 138344, 106177, 106171, 106172, 103192, 136111, 103193, 131424, 114359, 119812, 119810, 119811, 114360, 119819, 114361, 114362, 119818, 119431, 106980, 118683, 141591, 141588, 135606, 134973, 120299, 140023, 133387, 118506, 124306, 131547, 119429, 134504, 124311, 120676, 119657, 120678, 118505, 118687, 134763, 120677, 125045, 129436, 117945, 118461, 133148, 118679, 118684, 134503, 119082, 124312, 112076, 135371, 139646, 112077, 133484, 134972, 112635, 119085, 119237, 119240, 119238, 119236, 119239, 109370, 140530, 109371, 128053, 118680, 120512, 106624, 119086, 120675, 119824, 112631, 117947, 119083, 118598, 133446, 107332, 118681, 120510, 141587, 101356, 107328, 107330, 134505, 128052, 133894, 101357, 134502, 119825, 131388, 106383, 140616, 140620, 102503, 140615, 119084, 134501, 124234, 132853, 120511, 117946, 105230, 124316, 105885, 124308, 112630, 133517, 114219, 105229, 106384, 119080, 114348, 118386, 104138, 117995, 117063, 104139, 133486, 100038, 102860, 119828, 119784, 119829, 102504, 134331, 118385, 114216, 112632, 118922, 111777, 118384, 118706, 118704, 125264, 118705, 118702, 118709, 133445, 106215, 120443, 106221, 120445, 106216, 120444, 106214, 106213, 106217, 120507, 106212, 120509, 120508, 106222, 115092, 102206, 118583, 102205, 118921, 133518, 118987, 119081, 119606, 105884, 100724, 120282, 100725, 100723, 102054, 141593, 141595, 119815, 102053, 100037, 103884, 100641, 105080, 118623, 119605, 120283, 115093, 134498, 115094, 118924, 134497, 134496, 134494, 134495, 111963, 115091, 114218, 119106, 119107, 120135, 118584, 105883, 140235, 119858, 111786, 105436, 105669, 105878, 105668, 105434, 105667, 140236, 140237, 132849, 111962, 134499, 119817, 112721, 141594, 112355, 112722, 141589, 141592, 105433, 134493, 116653, 126166, 118460, 118350, 119813, 119816, 108757, 112125, 112123, 134500, 118234, 112354, 119857, 141060, 119856, 141061, 132848, 118986, 112369, 118232, 118233, 113071, 113070, 119108, 140304, 124233, 100087, 117061, 100078, 140306, 140302, 131389, 134419, 133895, 119750, 100077, 112014, 101839, 100089, 117062, 101837, 118954, 124303, 124315, 124310, 140308, 124313, 108756, 112723, 126389, 123693, 119751, 116298, 119379, 119381, 124305, 108701, 111754, 113254, 126165, 113251, 100079, 111750, 111746, 125265, 111753, 111749, 101840, 101838, 140298, 113253, 132852, 106227, 106231, 100088, 106228, 120062, 106230, 135191, 120739, 120736, 133127, 120735, 141958, 133469, 120737, 120734, 123692, 100384, 111743, 111751, 111745, 111752, 101989, 100386, 116297, 100318, 119850, 100387, 119849, 100058, 120703, 109264, 109269, 100385, 138898, 100316, 100319, 100057, 106229, 106233, 129925, 100317, 100383, 116296, 116299, 120702, 106234, 105605, 105627, 133130, 133733, 115483, 102544, 105658, 102545, 106232, 136345, 118955, 140192, 141161, 141160, 140196, 140198, 140195, 140194, 140199, 140197, 119522, 102591, 100388, 134420, 129926, 112422, 112475, 112461, 138900, 123690, 101990, 112423, 140233, 138297, 138299, 104429, 140229, 112424, 120061, 138298, 119851, 138301, 112120, 112122, 140297, 140230, 140232, 138289, 138288, 123691, 138286, 138287, 120060, 102141, 102143, 140182, 140190, 140185, 140188, 140176, 140183, 140180, 140184, 140178, 119532, 140307, 140189, 101599, 119415, 119416, 118409, 101600, 119533, 102592, 124832, 139602, 140305, 140310, 140301, 101407, 111704, 101408, 111705, 139603, 101763, 105401, 118594, 126030, 122152, 121412, 139768, 105659, 102538, 105670, 102540, 102541, 102539, 105578, 133919, 103178, 119625, 119629, 140303, 120451, 103183, 121413, 118691, 106186, 123663, 100780, 119626, 105400, 124596, 100793, 101762, 118519, 118595, 121722, 106185, 124833, 100781, 120452, 106183, 122165, 107071, 123646, 120450, 118326, 126031, 103734, 106366, 121182, 100783, 100784, 135500, 141067, 103735, 106411, 106057, 106365, 106337, 121721, 121181, 107070, 105692, 118689, 106338, 119535, 119739, 109617, 141066, 125952, 106709, 119627, 128079, 128006, 110024, 106060, 105689, 100782, 122715, 125077, 122721, 134417, 118520, 138903, 139616, 119427, 115068, 138905, 106707, 121034, 115069, 115131, 122719, 119428, 119188, 122712, 122720, 106412, 125953, 109465, 120975, 120902, 122641, 107226, 109464, 106413, 105639, 121033, 109618, 110021, 106706, 122612, 122711, 125078, 119186, 107228, 139617, 102547, 119187, 102546, 120970, 120903, 120877, 122642, 107193, 107195, 135501, 107088, 110468, 107089, 110469, 120876, 117944, 101373, 138564, 106145, 138580, 118053, 138579, 138567, 130055, 118054, 134418, 130050, 130052, 106146, 133810, 133812, 140769, 140770, 138566, 128009, 128078, 130054, 112408, 112648, 112649, 119707, 119706, 130053, 133867, 138571, 133868, 118492, 130056, 118491, 130037, 112343, 118490, 101934, 101001, 101952, 125497, 125496, 101950, 101951, 103191, 100999, 101932, 101935, 133809, 122651, 133805, 138472, 120396, 122982, 120398, 120399, 123705, 123704, 123706, 122904, 123707, 120397, 119705, 138474, 120425, 125216, 120426, 122531, 120424, 120427, 122607, 122995, 119613, 101619, 122748, 101617, 101618, 115511, 140771, 140772, 133922, 120257, 120763, 120762, 134788, 135536, 133180, 112352, 112353, 103145, 103146, 133852, 135336, 113078, 113361, 111545, 101803, 122891, 101802, 115510, 113077, 122606, 125494, 125495, 102676, 119087, 118654, 118508, 118497, 139181, 138470, 118498, 118718, 103050, 100541, 100547, 100593, 100620, 100833, 100875, 101044, 101078, 101184, 101409, 101714, 101972, 101973, 101986, 101994, 101997, 102443, 102701, 103160, 103343, 103349, 103392, 103634, 103736, 104140, 104484, 104559, 104685, 104686, 105025, 105553, 105554, 105565, 105882, 105888, 107329, 107700, 108633, 108650, 108692, 108992, 108995, 109108, 109349, 109372, 109501, 110598, 111647, 111676, 111707, 111744, 111747, 111970, 111971, 112211, 112215, 112425, 112645, 112658, 112712, 112720, 113102, 113252, 113307, 113483, 114217, 114301, 114302, 115401, 115515, 115992, 116488, 117868, 118293, 118307, 118315, 118366, 118368, 118383, 118400, 118450, 118459, 118477, 118507, 118578, 118703, 118843, 118861, 118901, 118906, 119089, 119093, 119109, 119124, 119136, 119163, 119203, 119301, 119346, 119349, 119368, 119380, 119414, 119421, 119432, 119482, 119483, 119500, 119513, 119524, 119679, 119688, 119764, 119848, 119862, 119864, 119983, 119984, 119985, 119986, 119993, 120007, 120009, 120037, 120065, 120134, 120188, 120209, 120248, 120316, 120376, 120377, 120388, 120411, 120432, 120506, 120515, 120534, 120566, 120772, 122168, 122236, 122443, 122444, 122643, 122645, 123287, 123288, 123710, 124265, 124266, 125342, 125349, 127311, 127313, 129647, 130473, 130486, 131354, 131356, 131450, 131451, 133681, 133682, 136567, 138285, 138342, 138361, 138467, 139238, 139239, 139259, 139260, 139388, 139390, 139431, 139432, 139534, 139535, 139540, 139560, 139562, 139583, 139585, 139604, 139605, 139618, 139619, 139891, 139892, 140004, 140005, 140086, 140177, 140181, 140193, 140437, 140614, 141065, 141159, 141162, 141247, 141248, 141249, 141250, 141808, 141862, 141887, 141888, 142037, 142038, 123708, 123711, 123709, 129193, 114100, 101048, 120029, 114097, 117948, 100494, 114105, 117950, 120030, 100493, 120519, 133569, 133570, 133629, 114099, 129194, 117951, 120522, 120520, 120521, 117949, 129191, 129192, 120792, 120791, 119185, 102509, 101594, 107476, 101593, 102514, 102512, 102510, 107471, 107477, 107472, 133571, 133572, 102511, 133628, 119636, 119637, 119635, 120084, 119875, 119876, 120086, 140291, 119638, 140288, 140293, 119877, 140286, 140290, 129200, 129201, 140284, 140294, 140283, 133791, 133792, 118908, 140292, 136563, 100417, 118486, 136569, 136570, 140289, 100418, 129065, 129199, 136568, 101186, 118487, 133787, 133782, 136564, 118514, 112867, 112869, 112870, 112868, 136566, 136565, 118513, 118960, 118959, 118962, 106840, 118961, 130062, 130064, 116484, 116485, 130504, 130503, 130061, 130063, 112328, 106841, 102109, 102110, 112327, 106839, 106838, 119691, 100621, 120575, 119730, 103394, 108691, 118367, 118904, 130502, 128545, 128543, 130501, 138332, 138329, 128538, 128539, 128544, 128540, 128541, 128542, 119119, 138330, 119118, 138331, 119120, 133280, 138323, 120690, 120576, 100645, 139339, 120615, 102149, 120613, 120689, 102147, 102148, 120616, 120614, 134998, 138315, 138270, 138317, 100742, 138318, 100741, 138271, 135581, 138316, 120579, 133872, 133869, 138268, 109350, 118308, 102331, 120313, 138254, 101127, 120314, 113097, 102330, 138256, 138277, 118285, 138265, 113098, 118286, 138274, 111722, 102139, 102140, 100842, 118056, 119284, 100895, 119467, 112445, 100041, 100044, 100046, 119791, 119569, 100852, 118695, 118516, 118515, 107701, 100537, 119061, 120745, 119062, 102112, 102111, 102442, 118512, 118511, 139971, 139972, 102108, 102107, 102948, 140141, 140142, 140140, 140143, 118767, 118769, 118770, 120688, 102915, 100548, 139970, 118579, 139969, 140296, 108252, 118665, 118668, 118666, 108249, 108258, 119314, 119397, 119564, 109366, 106260, 118294, 119563, 119398, 103313, 140295, 100375, 100377, 100376, 102947, 118049, 103308, 118070, 103309, 119308, 118844, 118050, 118069, 120687, 120766, 113103, 118451, 100682, 118316, 103312, 100896, 119469, 120073, 120074, 120075, 118650, 118651, 118652, 102260, 120068, 120069, 131355, 102261, 102262, 140819, 120502, 120503, 135341, 101161, 101162, 120705, 101163, 140815, 120550, 135342, 140817, 119842, 119843, 119840, 119841, 118784, 118782, 112322, 112323, 103006, 103007, 101818, 103408, 103400, 112360, 103401, 101816, 103409, 135120, 103086, 103085, 131357, 112361, 140820, 130465, 135343, 135344, 140653, 140816, 130474, 140818, 140660, 140658, 130487, 140659, 135122, 101804, 103348, 119123, 119364, 118311, 118309, 118310, 119365, 119565, 119566, 141642, 133056, 118476, 119363, 100600, 100601, 105000, 119241, 105001, 112378, 141807, 119242, 129212, 129211, 141644, 139520, 129213, 129210, 112359, 120423, 104772, 139521, 104773, 135124, 120780, 120781, 138313, 141810, 135121, 106425, 106426, 141643, 120665, 120664, 120001, 120593, 100664, 100663, 120002, 131671, 135125, 141645, 135123, 114565, 120155, 120154, 134597, 134599, 134594, 134595, 134601, 100353, 113567, 118576, 118575, 118574, 120111, 120082, 120083, 133053, 113566, 119578, 108305, 119577, 134596, 134598, 134593, 134602, 120592, 134600, 100949, 100948, 120504, 100950, 114859, 114858, 101537, 114564, 100354, 101536, 113560, 113562, 113561, 120478, 120479, 120480, 120477, 118550, 118551, 119066, 129440, 129441, 118423, 120505, 141564, 141567, 116632, 116633, 141565, 141566, 120268, 112925, 129438, 129439, 120267, 100900, 112927, 112924, 112926, 123652, 123654, 119279, 119280, 118675, 118678, 118676, 119298, 112293, 112347, 100378, 100379, 100380, 100332, 141877, 141878, 106871, 108595, 131666, 141875, 141876, 119556, 119557, 141925, 119297, 123651, 123653, 118193, 105805, 105804, 138307, 118194, 138312, 131670, 108908, 118489, 118488, 120673, 133035, 120674, 141927, 118424, 112329, 112330, 119767, 100685, 100684, 108909, 130547, 130543, 120778, 120789, 120779, 120790, 133036, 118481, 130540, 132995, 102533, 130533, 102535, 102536, 102534, 118480, 129312, 136464, 120158, 100286, 119834, 119727, 120157, 119389, 119390, 119391, 138308, 108594, 129309, 131373, 102756, 102765, 103234, 102663, 102662, 102661, 131375, 103233, 120822, 120823, 136463, 103491, 131374, 129310, 103490, 131372, 133054, 119718, 119717, 120468, 141069, 141068, 100630, 100631, 103215, 103216, 141926, 106167, 120784, 141916, 141915, 120467, 100646, 133051, 141913, 140487, 140486, 141914, 139519, 140489, 140488, 120466, 118548, 118549, 118272, 141928, 118478, 129311, 100536, 100535, 118479, 140065, 106166, 118485, 140068, 118271, 118484, 140066, 140067, 131665, 141932, 117560, 112277, 111550, 141931, 119252, 119253, 120700, 112331, 112332, 141929, 141930, 119772, 132996, 141070, 141071, 119773, 117691, 117692, 103338, 140654, 140655, 102136, 102135, 118494, 118493, 119256, 120465, 140656, 140657, 103339, 100496, 100497, 133515, 115944, 108799, 119959, 120598, 119720, 119721, 119960, 111549, 119017, 119018, 101530, 103024, 101906, 102118, 133516, 102000, 133049, 133057, 102001, 120771, 119545, 100678, 119542, 119441, 112278, 133052, 119440, 111381, 120046, 120045, 140348, 132997, 120663, 120662, 101472, 100617, 140350, 140347, 141933, 119403, 102252, 102251, 118736, 119404, 100669, 118738, 133513, 100668, 119457, 119458, 140349, 140352, 120488, 120599, 140351, 120487, 102336, 102337, 111382, 141934, 118103, 118102, 101228, 119159, 119160, 102848, 102846, 102847, 107410, 107409, 108800, 102036, 100475, 120538, 118274, 135601, 103167, 118543, 118542, 118273, 112152, 101656, 101657, 103168, 117559, 119019, 119894, 119020, 100082, 120539, 133050, 100081, 113222, 118834, 118835, 120586, 112932, 112931, 135598, 132998, 118269, 135600, 101706, 120585, 120680, 120679, 119506, 118270, 111957, 120276, 112109, 120275, 120277, 120274, 102138, 102137, 141918, 141920, 101866, 108465, 108466, 101867, 101869, 120349, 102808, 101868, 119437, 120723, 112944, 112153, 112108, 119585, 119598, 118794, 118793, 122766, 139679, 139712, 103616, 102807, 103504, 112012, 139711, 139709, 139710, 111958, 139680, 112936, 112937, 122765, 113545, 113221, 119527, 119893, 119438, 136473, 123004, 121146, 141917, 141919, 105460, 119528, 119076, 118928, 112089, 120166, 120348, 119077, 118929, 100997, 129188, 125351, 129190, 141006, 133514, 141005, 120165, 100998, 119710, 112090, 103174, 119711, 129189, 113544, 129187, 118624, 119604, 119609, 100080, 119157, 119156, 105875, 119158, 103114, 103034, 135764, 135763, 125354, 135762, 135765, 120722, 102885, 101551, 141007, 141004, 105459, 119507, 120285, 135759, 125301, 135761, 101738, 135760, 135766, 113141, 125350, 113143, 113142, 118625, 101271, 101266, 103173, 140442, 140444, 118275, 120782, 120783, 125306, 101737, 101922, 125307, 119367, 112013, 100807, 100806, 133384, 133386, 101923, 140446, 140447, 101265, 119071, 119485, 119070, 132756, 119281, 133385, 133383, 104481, 140353, 100474, 132757, 119484, 140354, 125352, 104482, 118276, 119518, 119519, 140355, 106876, 106875, 140356, 112943, 132183, 132184, 120079, 119366, 120078, 132178, 132179, 118540, 118541, 120259, 134875, 134876, 134877, 134878, 134879, 134880, 134881, 134882, 134883, 134884, 134885, 134886, 134887, 135976, 135977, 135978, 135980, 104706, 104707, 136094, 100525, 100526, 100325, 134846, 134847, 134863, 134864, 134865, 134867, 134868, 134869, 134870, 134871, 134872, 134873, 134874, 135979, 135981, 135982, 135983, 125305, 136090, 141951, 141952, 135599, 140175, 118473, 140174, 118882, 118881, 135807, 135808, 135810, 112949, 112948, 118472, 135809, 135811, 135812, 111569, 119053, 119058, 140172, 118777, 118778, 118775, 119723, 119722, 140173, 101222, 100414, 134014, 105628, 103883, 113179, 119591, 113177, 113178, 135682, 135681, 135684, 135683, 119590, 120834, 120835, 103111, 120726, 120727, 118693, 118692, 104638, 104637, 102393, 102394, 109275, 109274, 118632, 118633, 118634, 119290, 133325, 133324, 119291, 141767, 133323, 133322, 120147, 106236, 106235, 106240, 117608, 141404, 141407, 141072, 118044, 118043, 120146, 141405, 141406, 113464, 139527, 113463, 119646, 119647, 100063, 100064, 139530, 111570, 139528, 120825, 120826, 108403, 139529, 103110, 119769, 104514, 104515, 120824, 104513, 102528, 119768, 114456, 112038, 112039, 139992, 139991, 139989, 139990, 103039, 139782, 141062, 141063, 120381, 139781, 119470, 119471, 119472, 103040, 140382, 120380, 111942, 119581, 111941, 119582, 139783, 139780, 130498, 101498, 101538, 101499, 101539, 141475, 141476, 101500, 130499, 102529, 130496, 120153, 130497, 120152, 112207, 119588, 112064, 119589, 118614, 118884, 100476, 101209, 112117, 141766, 114457, 100794, 100795, 141813, 114458, 141814, 132989, 132990, 118615, 141949, 141950, 118870, 141812, 132987, 132988, 128236, 132185, 132189, 111640, 118883, 128233, 132175, 132174, 112118, 118871, 141811, 140381, 141145, 141146, 119595, 119594, 141462, 141477, 141143, 141144, 103743, 102142, 142133, 142134, 140383, 130491, 136113, 130493, 134813, 119544, 134816, 130490, 103164, 130492, 119543, 107745, 142135, 142136, 134814, 120524, 120523, 118619, 134815, 119219, 119218, 113064, 113065, 127042, 127044, 103819, 120841, 120840, 118620, 119660, 128235, 103820, 127039, 127040, 118539, 118538, 119131, 120760, 120761, 100524, 131453, 103151, 101066, 101065, 119130, 100067, 111599, 111638, 111602, 103130, 119661, 118527, 118526, 119988, 119987, 103131, 140384, 103678, 103679, 118537, 118536, 128234, 111639, 113460, 120251, 120243, 120242, 100521, 104331, 100522, 100356, 102133, 102134, 113461, 122390, 122389, 118801, 118803, 133865, 119548, 119549, 125712, 125711, 139839, 100614, 101853, 103196, 103197, 133866, 136114, 122387, 122388, 100355, 125714, 125713, 118483, 118580, 118581, 118482, 113069, 112877, 118455, 120620, 118347, 112878, 140084, 121366, 118742, 135607, 100484, 105067, 115512, 118740, 119288, 135106, 135320, 115284, 135391, 112351, 118741, 118743, 141545, 118745, 108479, 119063, 101349, 120716, 120717, 135390, 119778, 100823, 100822, 101659, 113062, 101525, 120309, 113063, 119826, 120307, 119827, 135853, 119648, 102272, 113298, 106442, 102273, 119779, 113296, 113297, 119649, 113300, 113299, 116352, 116353, 123635, 101314, 101313, 101201, 101200, 131452, 123636, 120252, 106441, 120260, 120261, 135783, 123637, 135782, 111787, 111903, 135781, 141141, 141142, 141139, 131865, 131866, 141140, 119178, 119177, 100321, 100323, 135784, 131864, 131863, 141740, 141743, 102328, 102326, 118877, 141741, 141742, 111939, 118876, 123638, 111935, 118935, 118934, 111940, 118344, 120393, 101765, 111788, 120356, 101764, 118616, 118878, 120392, 120725, 120724, 119255, 118617, 120714, 120715, 132187, 132186, 102266, 102267, 103154, 120682, 120681, 115943, 120657, 120656, 119658, 100820, 119659, 120517, 100821, 120518, 122639, 118448, 132180, 132181, 112098, 111936, 129047, 129046, 100740, 100739, 103155, 108166, 141873, 141874, 100650, 108167, 100651, 122640, 141871, 141872, 111938, 117311, 142140, 142138, 129048, 142137, 129049, 142139, 106144, 112099, 117310, 106143, 126279, 126278, 118826, 118510, 118509, 126378, 118872, 120357, 126379, 118825, 111937, 102884, 102883, 100477, 107578, 107579, 111642, 118873, 119783, 119782, 100644, 102823, 140227, 140228, 140107, 140225, 120412, 140226, 118534, 118535, 100520, 100519, 118278, 118277, 120413, 102920, 140256, 128331, 107353, 102921, 140255, 119278, 119277, 130860, 130861, 130864, 106596, 106597, 118756, 118758, 118759, 130858, 119060, 130859, 130863, 120793, 119059, 102433, 102431, 102432, 101980, 133709, 120270, 120269, 101979, 133710, 118866, 107352, 100865, 100864, 133712, 133711, 119326, 120750, 120749, 101912, 103025, 120335, 120334, 103026, 119325, 101143, 101144, 118867, 100480, 119287, 108402, 139840, 101746, 141578, 141580, 131331, 135672, 135854, 141842, 141841, 118547, 118546, 118790, 141839, 141840, 118785, 118791, 113294, 113271, 118788, 113295, 113269, 113270, 118786, 119065, 101705, 139581, 121109, 135321, 109010, 101281, 119958, 120308, 120312, 141579, 141581, 100550, 100549, 101199, 101198, 140813, 142110, 142108, 125111, 134045, 140812, 125110, 134044, 101913, 142107, 142109, 108597, 119134, 100068, 118532, 118533, 119339, 118837, 118838, 100472, 100473, 131581, 131580, 135659, 119148, 135656, 135658, 119149, 120402, 131579, 131578, 114931, 114930, 140810, 135801, 135805, 135806, 135660, 115790, 135657, 115788, 135661, 141428, 141430, 119133, 135804, 135802, 135803, 140811, 141429, 141431, 120403, 105503, 141414, 135677, 135679, 141415, 116548, 105504, 140243, 140242, 125597, 141410, 135680, 135678, 141411, 141897, 141898, 118419, 141895, 141896, 101609, 125596, 119251, 135654, 135653, 141226, 141223, 115942, 135652, 135655, 120828, 120827, 141224, 141225, 125595, 108596, 100177, 100176, 140089, 106929, 116547, 101834, 120263, 120264, 101591, 100312, 100313, 120417, 101815, 119620, 119486, 101592, 119619, 125598, 140814, 119433, 119436, 142153, 142154, 120416, 118420, 142152, 142151, 140809, 119489, 141829, 100033, 100156, 141830, 100034, 127071, 127072, 127070, 127073, 119352, 104636, 119351, 100351, 111710, 111709, 120587, 100352, 119231, 119233, 119232, 120597, 120588, 112218, 102428, 101672, 104635, 120043, 120044, 107989, 111711, 107988, 120731, 120730, 102398, 102397, 111708, 120596, 126352, 126353, 126351, 126350, 100349, 100348, 119835, 119724, 140095, 118591, 118588, 118589, 102414, 100915, 101864, 101862, 101863, 102595, 119174, 119176, 119175, 102594, 120323, 120751, 120752, 115101, 114855, 114854, 103097, 103098, 119057, 120322, 108377, 108378, 120385, 120384, 135789, 135792, 135793, 135794, 135790, 135791, 136006, 136007, 136005, 136004, 132933, 132934, 132923, 132924, 118722, 118724, 118725, 133857, 133859, 102753, 102751, 102752, 133858, 133860, 113134, 133363, 133364, 133362, 133361, 119202, 119201, 113327, 113328, 101823, 101824, 119313, 119392, 113049, 106193, 113434, 113076, 111954, 112368, 115127, 107693, 115939, 119354, 102020, 105463, 109446, 120245, 102021, 109445, 119353, 120244, 119312, 101491, 118558, 118559, 106979, 106978, 120565, 120564, 103165, 103166, 134017, 133908, 118988, 118989, 105758, 105757, 134015, 134016, 140327, 140328, 138453, 138457, 119132, 119781, 119780, 115934, 114757, 114758, 119596, 119597, 109061, 109060, 109058, 109059, 138454, 138456, 118662, 118663, 120686, 120685, 114616, 114617, 115833, 115834, 140088, 118343, 117714, 132140, 132141, 120732, 120733, 132139, 132138, 102401, 102402, 120842, 120843, 109830, 109831, 141064, 115132, 120472, 120473, 115897, 115898, 119275, 119276, 112127, 112126, 118868, 117547, 117312, 118869, 117313, 117549, 119333, 119334, 119789, 119788, 115676, 115677, 135859, 140087, 133122, 134008, 119576, 119575, 111348, 111349, 120545, 120546, 116795, 116796, 120530, 120531, 116075, 116077]

linkArr = []
for i in range(len(schemeCode)):
  link = "https://api.mfapi.in/mf/" + str(schemeCode[i])
  linkArr.append(link)

schemeCode = np.unique(schemeCode)

totalSize = len(schemeCode)

with open(filename, 'w', newline='') as f_object:
            writer_object = writer(f_object)        
            writer_object.writerow(["Scheme Name","Scheme Category","Fund House","Scheme Code","Date","Nav","Date","Nav","Date","Nav","Date","Nav"])
            f_object.close()

for i in range(20):

    try: 
      if(i%1000==0):
          print("Sleeping 10 sec")
          print("--- %s seconds ---" % (time.time() - start_time))
          time.sleep(10)
      response = requests.get(linkArr[i],verify=False).text
      response_info = json.loads(response)
      if(len(response_info["data"]) > 3):
        with open(filename, 'a+', newline='') as f_object:
            writer_object = writer(f_object)        
            writer_object.writerow([response_info["meta"]['scheme_name'],
                                    response_info["meta"]['scheme_category'],
                                    response_info["meta"]['fund_house'],
                                    response_info["meta"]['scheme_code'],
                                    response_info["data"][0]["date"],
                                    response_info["data"][0]["nav"],
                                    response_info["data"][1]["date"],
                                    response_info["data"][1]["nav"],
                                    response_info["data"][2]["date"],
                                    response_info["data"][2]["nav"],
                                    response_info["data"][3]["date"],
                                    response_info["data"][3]["nav"]]                            
                                    )

            f_object.close()

      print(str(i) + " out off "+ str(totalSize) + " Completed " + str(response_info["meta"]['scheme_code']))
    except:
      print("Connection refused by the server..")
      print("Let me sleep for 5 seconds")
      print("ZZzzzz...")
      time.sleep(5)
      print("Was a nice sleep, now let me continue...")
      continue

print("--- %s seconds ---" % (time.time() - start_time))
print("curl -F " + '"file=@'+filename+'"'+" https://file.io")

mail_Alert()


